var Planit,
  __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

Planit = (function() {
  function Planit() {
    this.getAllMarkers = __bind(this.getAllMarkers, this);
    this.addMarker = __bind(this.addMarker, this);
  }

  Planit.prototype["new"] = function(_at_options) {
    this.options = _at_options;
    if (!this.options) {
      this.options = {};
    }
    this.planOptions = {
      container: $('#planit')
    };
    if (this.options.container) {
      this.planOptions.container = $("#" + this.options.container);
    }
    if (this.options.backgroundImage) {
      this.planOptions.backgroundImage = this.options.backgroundImage;
    }
    this.plan = new Planit.Plan(this.planOptions);
    if (this.options.markers) {
      $(window).load((function(_this) {
        return function() {
          var marker, _i, _len, _ref, _results;
          _ref = _this.options.markers;
          _results = [];
          for (_i = 0, _len = _ref.length; _i < _len; _i++) {
            marker = _ref[_i];
            _results.push(_this.addMarker(marker));
          }
          return _results;
        };
      })(this));
    }
    return this;
  };

  Planit.prototype.addMarker = function(options) {
    options.plan = this.planOptions.container;
    return new Planit.Marker(options);
  };

  Planit.prototype.getAllMarkers = function() {
    return this.plan.getAllMarkers();
  };

  return Planit;

})();

window.planit = new Planit;

Planit.Plan = (function() {
  function Plan(_at_options) {
    this.options = _at_options;
    this.getAllMarkers = __bind(this.getAllMarkers, this);
    this.initContainers();
    if (this.options.backgroundImage) {
      this.addBackgroundImage();
    }
  }

  Plan.prototype.initContainers = function() {
    this.container = this.options.container;
    this.container.addClass('planit-container');
    this.container.append("<div class=\"planit-markers-container\"></div>");
    return this.markersContainer = this.container.find('.planit-markers-container').first();
  };

  Plan.prototype.addBackgroundImage = function() {
    this.container.append("<img src=\"" + this.options.backgroundImage + "\">");
    this.markersContainer.css({
      backgroundImage: "url('" + this.options.backgroundImage + "')"
    });
    return $(window).load((function(_this) {
      return function() {
        _this.container.css({
          height: _this.container.find('img').first().height()
        });
        return _this.container.find('img').first().remove();
      };
    })(this));
  };

  Plan.prototype.getAllMarkers = function() {
    var info, m, marker, markers, _i, _len, _ref;
    markers = [];
    _ref = this.markersContainer.find('.planit-marker');
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      marker = _ref[_i];
      m = $(marker);
      marker = {
        coords: [m.position().left, m.position().top]
      };
      info = m.find('.planit-infobox');
      if (info.length > 0) {
        marker.infobox = info.html();
      }
      markers.push(marker);
    }
    return markers;
  };

  return Plan;

})();

Planit.Marker = (function() {
  function Marker(_at_options) {
    var id, infobox;
    this.options = _at_options;
    this.mousemove = __bind(this.mousemove, this);
    this.mouseup = __bind(this.mouseup, this);
    this.mousedown = __bind(this.mousedown, this);
    this.plan = this.options.plan;
    this.markersContainer = this.plan.find('.planit-markers-container');
    $(document).on('mousemove', this.mousemove);
    $(document).on('mouseup', this.mouseup);
    this.markersContainer.append($('<div><div class="planit-marker-content"></div></div>').addClass('planit-marker').css({
      left: this.options.coords[0] + "%",
      top: this.options.coords[1] + "%"
    }));
    if (this.options.draggable) {
      this.lastMarker().addClass('draggable');
      this.lastMarker().on('mousedown', this.mousedown);
    }
    if (this.options.infobox) {
      id = this.randomString(16);
      this.lastMarker().find('.planit-marker-content').append("<div class=\"planit-infobox\" id=\"info-" + id + "\">" + this.options.infobox + "</div>");
      this.lastMarker().attr('data-infobox', "info-" + id);
      infobox = $("#" + (this.lastMarker().attr('data-infobox')));
      infobox.css({
        left: -(infobox.width() / 2),
        bottom: infobox.outerHeight() + 5
      });
      this.lastMarker().on('mouseleave', (function(_this) {
        return function(e) {
          var marker;
          marker = $(e.target).closest('.planit-marker');
          infobox = $("#" + (marker.attr('data-infobox')));
          return infobox.removeClass('active');
        };
      })(this));
      this.lastMarker().on('mouseover', (function(_this) {
        return function(e) {
          var marker;
          marker = $(e.target).closest('.planit-marker');
          infobox = $("#" + (marker.attr('data-infobox')));
          if (marker.hasClass('is-dragging') || _this.draggingMarker().length > 0) {
            return infobox.removeClass('active');
          } else {
            return infobox.addClass('active');
          }
        };
      })(this));
    }
  }

  Marker.prototype.mousedown = function(e) {
    var infoboxID, marker;
    marker = $(e.target).closest('.planit-marker');
    marker.addClass('is-dragging');
    infoboxID = $(e.target).closest('.planit-marker').attr('data-infobox');
    return $("#" + infoboxID).removeClass('active');
  };

  Marker.prototype.mouseup = function(e) {
    var marker;
    if ($(e.target).hasClass('planit-marker-content')) {
      marker = $(e.target).closest('.planit-marker');
      $("#" + (marker.attr('data-infobox'))).addClass('active');
    }
    return this.draggingMarker().removeClass('is-dragging');
  };

  Marker.prototype.mousemove = function(e) {
    var marker, markerBottom, markerHeight, markerLeft, markerRight, markerTop, markerWidth, markerX, markerY, markers, mouseLeft, mouseTop, planBottom, planRight;
    markers = this.markersContainer.find('.planit-marker.is-dragging');
    if (markers.length > 0) {
      marker = markers.first();
      mouseLeft = e.pageX - this.plan.offset().left;
      mouseTop = e.pageY - this.plan.offset().top;
      planRight = this.plan.width();
      planBottom = this.plan.height();
      markerLeft = mouseLeft - (marker.outerWidth() / 2);
      markerTop = mouseTop - (marker.outerHeight() / 2);
      markerRight = mouseLeft + (marker.outerWidth() / 2);
      markerBottom = mouseTop + (marker.outerHeight() / 2);
      markerWidth = marker.outerWidth();
      markerHeight = marker.outerHeight();
      if (markerLeft <= 0) {
        markerX = 0;
      } else if (markerRight < planRight) {
        markerX = markerLeft;
      } else {
        markerX = planRight - markerWidth;
      }
      if (markerTop <= 0) {
        markerY = 0;
      } else if (markerBottom < planBottom) {
        markerY = markerTop;
      } else {
        markerY = planBottom - markerHeight;
      }
      return marker.css({
        left: markerX,
        top: markerY
      });
    }
  };

  Marker.prototype.markers = function() {
    return this.markersContainer.find('.planit-marker');
  };

  Marker.prototype.draggingMarker = function() {
    return this.markersContainer.find('.planit-marker.is-dragging');
  };

  Marker.prototype.lastMarker = function() {
    return this.markers().last();
  };

  Marker.prototype.randomString = function(length) {
    var str;
    if (length == null) {
      length = 16;
    }
    str = Math.random().toString(36).slice(2);
    str = str + Math.random().toString(36).slice(2);
    return str.substring(0, length - 1);
  };

  return Marker;

})();

//# sourceMappingURL=data:application/json;base64,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O0tBQ3RCO0FBQUEsSUFBQSxHQUFBLEdBQU0sSUFBSSxDQUFDLE1BQUwsQ0FBQSxDQUFhLENBQUMsUUFBZCxDQUF1QixFQUF2QixDQUEwQixDQUFDLEtBQTNCLENBQWlDLENBQWpDLENBQU4sQ0FBQTtBQUFBLElBQ0EsR0FBQSxHQUFNLEdBQUEsR0FBTSxJQUFJLENBQUMsTUFBTCxDQUFBLENBQWEsQ0FBQyxRQUFkLENBQXVCLEVBQXZCLENBQTBCLENBQUMsS0FBM0IsQ0FBaUMsQ0FBakMsQ0FEWixDQUFBO1dBRUEsR0FBRyxDQUFDLFNBQUosQ0FBYyxDQUFkLEVBQWlCLE1BQUEsR0FBUyxDQUExQixFQUhZO0VBQUEsQ0FoSGQsQ0FBQTs7Z0JBQUE7O0lBL0VGLENBQUEiLCJmaWxlIjoicGxhbml0LXRtcC5qcyIsInNvdXJjZVJvb3QiOiIvc291cmNlLyIsInNvdXJjZXNDb250ZW50IjpbImNsYXNzIFBsYW5pdFxuXG4gICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIERlZmF1bHQgT3B0aW9uc1xuXG4gIG5ldzogKEBvcHRpb25zKSAtPlxuXG4gICAgIyBEZWZhdWx0IE9wdGlvbnNcbiAgICBAb3B0aW9ucyA9IHt9IHVubGVzcyBAb3B0aW9uc1xuICAgIEBwbGFuT3B0aW9ucyA9XG4gICAgICBjb250YWluZXI6ICQoJyNwbGFuaXQnKVxuXG4gICAgIyBJbnB1dCBPcHRpb25zXG4gICAgaWYgQG9wdGlvbnMuY29udGFpbmVyXG4gICAgICBAcGxhbk9wdGlvbnMuY29udGFpbmVyID0gJChcIiMje0BvcHRpb25zLmNvbnRhaW5lcn1cIilcbiAgICBpZiBAb3B0aW9ucy5iYWNrZ3JvdW5kSW1hZ2VcbiAgICAgIEBwbGFuT3B0aW9ucy5iYWNrZ3JvdW5kSW1hZ2UgPSBAb3B0aW9ucy5iYWNrZ3JvdW5kSW1hZ2VcblxuICAgICMgSW5pdGlhbGl6ZSBQbGFuXG4gICAgQHBsYW4gPSBuZXcgUGxhbml0LlBsYW4oQHBsYW5PcHRpb25zKVxuXG4gICAgIyBBZGQgTWFya2VycyAoaWYgbmVjZXNzYXJ5KVxuICAgIGlmIEBvcHRpb25zLm1hcmtlcnNcbiAgICAgICQod2luZG93KS5sb2FkICgpID0+XG4gICAgICAgIEBhZGRNYXJrZXIobWFya2VyKSBmb3IgbWFya2VyIGluIEBvcHRpb25zLm1hcmtlcnNcblxuICAgICMgUmV0dXJuIHRoaXMgUGxhbml0IG9iamVjdFxuICAgIEBcblxuICAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBBZGQgQSBNYXJrZXJcblxuICBhZGRNYXJrZXI6IChvcHRpb25zKSA9PlxuICAgIG9wdGlvbnMucGxhbiA9IEBwbGFuT3B0aW9ucy5jb250YWluZXJcbiAgICBuZXcgUGxhbml0Lk1hcmtlcihvcHRpb25zKVxuXG4gICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIEdldCBBbGwgTWFya2Vyc1xuXG4gIGdldEFsbE1hcmtlcnM6ICgpID0+XG4gICAgQHBsYW4uZ2V0QWxsTWFya2VycygpXG5cbiMgc2V0IHRoaXMgY2xhc3MgdG8gYSBnbG9iYWwgYHBsYW5pdGAgdmFyaWFibGVcbndpbmRvdy5wbGFuaXQgPSBuZXcgUGxhbml0XG5cbmNsYXNzIFBsYW5pdC5QbGFuXG5cbiAgY29uc3RydWN0b3I6IChAb3B0aW9ucykgLT5cbiAgICBAaW5pdENvbnRhaW5lcnMoKVxuICAgIEBhZGRCYWNrZ3JvdW5kSW1hZ2UoKSBpZiBAb3B0aW9ucy5iYWNrZ3JvdW5kSW1hZ2VcblxuICBpbml0Q29udGFpbmVyczogLT5cbiAgICBAY29udGFpbmVyID0gQG9wdGlvbnMuY29udGFpbmVyXG4gICAgQGNvbnRhaW5lci5hZGRDbGFzcygncGxhbml0LWNvbnRhaW5lcicpXG4gICAgQGNvbnRhaW5lci5hcHBlbmQoXCJcIlwiPGRpdiBjbGFzcz1cInBsYW5pdC1tYXJrZXJzLWNvbnRhaW5lclwiPjwvZGl2PlwiXCJcIilcbiAgICBAbWFya2Vyc0NvbnRhaW5lciA9IEBjb250YWluZXIuZmluZCgnLnBsYW5pdC1tYXJrZXJzLWNvbnRhaW5lcicpLmZpcnN0KClcblxuICBhZGRCYWNrZ3JvdW5kSW1hZ2U6IC0+XG4gICAgQGNvbnRhaW5lci5hcHBlbmQoXCJcIlwiPGltZyBzcmM9XCIje0BvcHRpb25zLmJhY2tncm91bmRJbWFnZX1cIj5cIlwiXCIpXG4gICAgQG1hcmtlcnNDb250YWluZXIuY3NzXG4gICAgICBiYWNrZ3JvdW5kSW1hZ2U6IFwidXJsKCcje0BvcHRpb25zLmJhY2tncm91bmRJbWFnZX0nKVwiXG4gICAgJCh3aW5kb3cpLmxvYWQgPT5cbiAgICAgIEBjb250YWluZXIuY3NzXG4gICAgICAgIGhlaWdodDogQGNvbnRhaW5lci5maW5kKCdpbWcnKS5maXJzdCgpLmhlaWdodCgpXG4gICAgICBAY29udGFpbmVyLmZpbmQoJ2ltZycpLmZpcnN0KCkucmVtb3ZlKClcblxuICAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBHZXQgQWxsIE1hcmtlcnNcblxuICBnZXRBbGxNYXJrZXJzOiAoKSA9PlxuICAgIG1hcmtlcnMgPSBbXVxuICAgIGZvciBtYXJrZXIgaW4gQG1hcmtlcnNDb250YWluZXIuZmluZCgnLnBsYW5pdC1tYXJrZXInKVxuICAgICAgbSA9ICQobWFya2VyKVxuICAgICAgbWFya2VyID1cbiAgICAgICAgY29vcmRzOiBbbS5wb3NpdGlvbigpLmxlZnQsIG0ucG9zaXRpb24oKS50b3BdXG4gICAgICBpbmZvID0gbS5maW5kKCcucGxhbml0LWluZm9ib3gnKVxuICAgICAgaWYgaW5mby5sZW5ndGggPiAwXG4gICAgICAgIG1hcmtlci5pbmZvYm94ID0gaW5mby5odG1sKClcbiAgICAgIG1hcmtlcnMucHVzaChtYXJrZXIpXG4gICAgbWFya2Vyc1xuXG5jbGFzcyBQbGFuaXQuTWFya2VyXG5cbiAgY29uc3RydWN0b3I6IChAb3B0aW9ucykgLT5cblxuICAgICMgZGVmYXVsdCBvcHRpb25zXG4gICAgQHBsYW4gPSBAb3B0aW9ucy5wbGFuXG4gICAgQG1hcmtlcnNDb250YWluZXIgPSBAcGxhbi5maW5kKCcucGxhbml0LW1hcmtlcnMtY29udGFpbmVyJylcblxuICAgICMgYmluZCBkcmFnZ2FibGUgZXZlbnRzXG4gICAgJChkb2N1bWVudCkub24oJ21vdXNlbW92ZScsIEBtb3VzZW1vdmUpXG4gICAgJChkb2N1bWVudCkub24oJ21vdXNldXAnLCBAbW91c2V1cClcblxuICAgICMgYWRkIG1hcmtlclxuICAgIEBtYXJrZXJzQ29udGFpbmVyLmFwcGVuZChcbiAgICAgICQoJzxkaXY+PGRpdiBjbGFzcz1cInBsYW5pdC1tYXJrZXItY29udGVudFwiPjwvZGl2PjwvZGl2PicpXG4gICAgICAgIC5hZGRDbGFzcygncGxhbml0LW1hcmtlcicpXG4gICAgICAgIC5jc3NcbiAgICAgICAgICBsZWZ0OiBcIiN7QG9wdGlvbnMuY29vcmRzWzBdfSVcIlxuICAgICAgICAgIHRvcDogXCIje0BvcHRpb25zLmNvb3Jkc1sxXX0lXCJcbiAgICApXG4gICAgaWYgQG9wdGlvbnMuZHJhZ2dhYmxlXG4gICAgICBAbGFzdE1hcmtlcigpLmFkZENsYXNzKCdkcmFnZ2FibGUnKVxuICAgICAgQGxhc3RNYXJrZXIoKS5vbignbW91c2Vkb3duJywgQG1vdXNlZG93bilcbiAgICBpZiBAb3B0aW9ucy5pbmZvYm94XG4gICAgICBpZCA9IEByYW5kb21TdHJpbmcoMTYpXG4gICAgICBAbGFzdE1hcmtlcigpLmZpbmQoJy5wbGFuaXQtbWFya2VyLWNvbnRlbnQnKS5hcHBlbmQgXCJcIlwiXG4gICAgICAgIDxkaXYgY2xhc3M9XCJwbGFuaXQtaW5mb2JveFwiIGlkPVwiaW5mby0je2lkfVwiPiN7QG9wdGlvbnMuaW5mb2JveH08L2Rpdj5cbiAgICAgICAgICBcIlwiXCJcbiAgICAgIEBsYXN0TWFya2VyKCkuYXR0cignZGF0YS1pbmZvYm94JywgXCJpbmZvLSN7aWR9XCIpXG4gICAgICBpbmZvYm94ID0gJChcIiMje0BsYXN0TWFya2VyKCkuYXR0cignZGF0YS1pbmZvYm94Jyl9XCIpXG4gICAgICBpbmZvYm94LmNzc1xuICAgICAgICBsZWZ0OiAtKGluZm9ib3gud2lkdGgoKSAvIDIpXG4gICAgICAgIGJvdHRvbTogaW5mb2JveC5vdXRlckhlaWdodCgpICsgNVxuICAgICAgQGxhc3RNYXJrZXIoKS5vbiAnbW91c2VsZWF2ZScsIChlKSA9PlxuICAgICAgICBtYXJrZXIgPSAkKGUudGFyZ2V0KS5jbG9zZXN0KCcucGxhbml0LW1hcmtlcicpXG4gICAgICAgIGluZm9ib3ggPSAkKFwiIyN7bWFya2VyLmF0dHIoJ2RhdGEtaW5mb2JveCcpfVwiKVxuICAgICAgICBpbmZvYm94LnJlbW92ZUNsYXNzKCdhY3RpdmUnKVxuICAgICAgQGxhc3RNYXJrZXIoKS5vbiAnbW91c2VvdmVyJywgKGUpID0+XG4gICAgICAgIG1hcmtlciA9ICQoZS50YXJnZXQpLmNsb3Nlc3QoJy5wbGFuaXQtbWFya2VyJylcbiAgICAgICAgaW5mb2JveCA9ICQoXCIjI3ttYXJrZXIuYXR0cignZGF0YS1pbmZvYm94Jyl9XCIpXG4gICAgICAgIGlmIG1hcmtlci5oYXNDbGFzcygnaXMtZHJhZ2dpbmcnKSB8fCBAZHJhZ2dpbmdNYXJrZXIoKS5sZW5ndGggPiAwXG4gICAgICAgICAgaW5mb2JveC5yZW1vdmVDbGFzcygnYWN0aXZlJylcbiAgICAgICAgZWxzZVxuICAgICAgICAgIGluZm9ib3guYWRkQ2xhc3MoJ2FjdGl2ZScpXG5cbiAgbW91c2Vkb3duOiAoZSkgPT5cbiAgICBtYXJrZXIgPSAkKGUudGFyZ2V0KS5jbG9zZXN0KCcucGxhbml0LW1hcmtlcicpXG4gICAgbWFya2VyLmFkZENsYXNzKCdpcy1kcmFnZ2luZycpXG4gICAgaW5mb2JveElEID0gJChlLnRhcmdldCkuY2xvc2VzdCgnLnBsYW5pdC1tYXJrZXInKS5hdHRyKCdkYXRhLWluZm9ib3gnKVxuICAgICQoXCIjI3tpbmZvYm94SUR9XCIpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKVxuXG4gIG1vdXNldXA6IChlKSA9PlxuICAgIGlmICQoZS50YXJnZXQpLmhhc0NsYXNzKCdwbGFuaXQtbWFya2VyLWNvbnRlbnQnKVxuICAgICAgbWFya2VyID0gJChlLnRhcmdldCkuY2xvc2VzdCgnLnBsYW5pdC1tYXJrZXInKVxuICAgICAgJChcIiMje21hcmtlci5hdHRyKCdkYXRhLWluZm9ib3gnKX1cIikuYWRkQ2xhc3MoJ2FjdGl2ZScpXG4gICAgQGRyYWdnaW5nTWFya2VyKCkucmVtb3ZlQ2xhc3MoJ2lzLWRyYWdnaW5nJylcblxuICBtb3VzZW1vdmU6IChlKSA9PlxuICAgIG1hcmtlcnMgPSBAbWFya2Vyc0NvbnRhaW5lci5maW5kKCcucGxhbml0LW1hcmtlci5pcy1kcmFnZ2luZycpXG4gICAgaWYgbWFya2Vycy5sZW5ndGggPiAwXG5cbiAgICAgICMgb25seSB1c2UgZmlyc3QgbWFya2VyIGluIGNhc2UgdGhlcmUgYXJlIG1vcmUgdGhhblxuICAgICAgIyBvbmUgZHJhZ2dpbmdcbiAgICAgICMgXG4gICAgICBtYXJrZXIgPSBtYXJrZXJzLmZpcnN0KClcblxuICAgICAgIyBjYWxjdWxhdGUgcG9zaXRpb25zXG4gICAgICAjIFxuICAgICAgbW91c2VMZWZ0ICAgICA9IGUucGFnZVggLSBAcGxhbi5vZmZzZXQoKS5sZWZ0XG4gICAgICBtb3VzZVRvcCAgICAgID0gZS5wYWdlWSAtIEBwbGFuLm9mZnNldCgpLnRvcFxuICAgICAgcGxhblJpZ2h0ICAgICA9IEBwbGFuLndpZHRoKClcbiAgICAgIHBsYW5Cb3R0b20gICAgPSBAcGxhbi5oZWlnaHQoKVxuICAgICAgbWFya2VyTGVmdCAgICA9IG1vdXNlTGVmdCAtIChtYXJrZXIub3V0ZXJXaWR0aCgpIC8gMilcbiAgICAgIG1hcmtlclRvcCAgICAgPSBtb3VzZVRvcCAtIChtYXJrZXIub3V0ZXJIZWlnaHQoKSAvIDIpXG4gICAgICBtYXJrZXJSaWdodCAgID0gbW91c2VMZWZ0ICsgKG1hcmtlci5vdXRlcldpZHRoKCkgLyAyKVxuICAgICAgbWFya2VyQm90dG9tICA9IG1vdXNlVG9wICsgKG1hcmtlci5vdXRlckhlaWdodCgpIC8gMilcbiAgICAgIG1hcmtlcldpZHRoICAgPSBtYXJrZXIub3V0ZXJXaWR0aCgpXG4gICAgICBtYXJrZXJIZWlnaHQgID0gbWFya2VyLm91dGVySGVpZ2h0KClcblxuICAgICAgIyBmaW5kIHRoZSBsZWZ0IHBvc2l0aW9uIG9mIHRoZSBtYXJrZXIgYmFzZWQgb25cbiAgICAgICMgcG9zaXRpb24gb2YgdGhlIG1vdXNlIHJlbGF0aXZlIHRvIHRoZSBwbGFuXG4gICAgICAjIFxuICAgICAgaWYgbWFya2VyTGVmdCA8PSAwXG4gICAgICAgIG1hcmtlclggPSAwXG4gICAgICBlbHNlIGlmIG1hcmtlclJpZ2h0IDwgcGxhblJpZ2h0XG4gICAgICAgIG1hcmtlclggPSBtYXJrZXJMZWZ0XG4gICAgICBlbHNlXG4gICAgICAgIG1hcmtlclggPSBwbGFuUmlnaHQgLSBtYXJrZXJXaWR0aFxuXG4gICAgICAjIGZpbmQgdGhlIGxlZnQgcG9zaXRpb24gb2YgdGhlIG1hcmtlciBiYXNlZCBvblxuICAgICAgIyBwb3NpdGlvbiBvZiB0aGUgbW91c2UgcmVsYXRpdmUgdG8gdGhlIHBsYW5cbiAgICAgICMgXG4gICAgICBpZiBtYXJrZXJUb3AgPD0gMFxuICAgICAgICBtYXJrZXJZID0gMFxuICAgICAgZWxzZSBpZiBtYXJrZXJCb3R0b20gPCBwbGFuQm90dG9tXG4gICAgICAgIG1hcmtlclkgPSBtYXJrZXJUb3BcbiAgICAgIGVsc2VcbiAgICAgICAgbWFya2VyWSA9IHBsYW5Cb3R0b20gLSBtYXJrZXJIZWlnaHRcblxuICAgICAgIyBzZXQgdGhlIHBvc2l0aW9uIG9mIHRoZSBtYXJrZXJcbiAgICAgICMgXG4gICAgICBtYXJrZXIuY3NzXG4gICAgICAgIGxlZnQ6IG1hcmtlclhcbiAgICAgICAgdG9wOiBtYXJrZXJZXG5cbiAgbWFya2VyczogLT5cbiAgICBAbWFya2Vyc0NvbnRhaW5lci5maW5kKCcucGxhbml0LW1hcmtlcicpXG5cbiAgZHJhZ2dpbmdNYXJrZXI6IC0+XG4gICAgQG1hcmtlcnNDb250YWluZXIuZmluZCgnLnBsYW5pdC1tYXJrZXIuaXMtZHJhZ2dpbmcnKVxuXG4gIGxhc3RNYXJrZXI6IC0+XG4gICAgQG1hcmtlcnMoKS5sYXN0KClcblxuICByYW5kb21TdHJpbmc6IChsZW5ndGggPSAxNikgLT5cbiAgICBzdHIgPSBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zbGljZSgyKSBcbiAgICBzdHIgPSBzdHIgKyBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zbGljZSgyKVxuICAgIHN0ci5zdWJzdHJpbmcoMCwgbGVuZ3RoIC0gMSlcbiJdfQ==